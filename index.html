<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no">
<title>Sex o Pol</title>

<style>

/* ===== BASE ===== */
html, body {
  margin: 0;
  padding: 0;
  width: 100vw;
  height: 100dvh;
  background: #000;
  font-family: Arial, sans-serif;
  color: white;
  overflow: hidden;
  -webkit-tap-highlight-color: transparent;
  overscroll-behavior: none;
}

* {
  box-sizing: border-box;
  touch-action: manipulation;
}

body {
  display: flex;
}

/* ===== LAYOUT ===== */
#gameWrapper {
  width: 100vw;
  height: 100dvh;
  display: flex;
  flex-direction: row;
}

/* ===== BOARD ===== */
#board {
  flex: 1740;
  height: 100dvh;
  background: url("board.png") no-repeat left center;

  /* üî• KUTTER 200px AV H√òYRESIDEN AV BILDET */
  background-size: calc(100% + 200px) 100%;
  background-position: left center;

  position: relative;
  flex-shrink: 0;
}

/* ===== UI ===== */
#sideUI {
  flex: 816;
  height: 100dvh;
  padding: 18px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  background: #000;
}

/* ===== SPILLERBRIKKER ===== */
.player {
  position: absolute;
  width: 4vh;
  height: 4vh;
  border-radius: 50%;
  transform: translate(-50%, -50%);
  transition: left 0.25s ease, top 0.25s ease;
  z-index: 10;
  border: 2px solid #fff;
}

#p1 { background: #ff4d4d; }
#p2 { background: #4da6ff; }

/* ===== UI STYLE ===== */
input, button {
  padding: 12px;
  font-size: 18px;
  border-radius: 10px;
  border: none;
}

input { width: 100%; }

button {
  cursor: pointer;
  font-weight: bold;
  min-height: 60px;
  background: #4da6ff;
  color: white;
}

button:active { transform: scale(0.97); }

#dice {
  display: flex;
  gap: 20px;
  font-size: 42px;
  justify-content: center;
}

#scores { font-size: 20px; }

#turnIndicator {
  font-weight: bold;
  text-align: center;
  font-size: 20px;
}

/* ===== KORT ===== */
#card {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 50;
}

#cardContent {
  background: #111;
  padding: 30px;
  max-width: 80vw;
  border-radius: 14px;
  text-align: center;
}

/* ===== ROTASJON ADVARSEL ===== */
#rotateWarning {
  position: fixed;
  inset: 0;
  background: black;
  color: white;
  display: none;
  justify-content: center;
  align-items: center;
  font-size: 22px;
  z-index: 100;
}

</style>
</head>

<body>

<div id="rotateWarning">
  üîÑ Snu telefonen til liggende for √• spille
</div>

<div id="gameWrapper">

  <div id="board">
    <div id="p1" class="player"></div>
    <div id="p2" class="player"></div>
  </div>

  <div id="sideUI">

    <div>
      <input id="name1Input" placeholder="Spiller 1" autocomplete="off" />
      <input id="name2Input" placeholder="Spiller 2" autocomplete="off" />
    </div>

    <div id="scores">
      <div id="score1"></div>
      <div id="score2"></div>
    </div>

    <div id="turnIndicator"></div>

    <div id="dice">
      <div id="d1">üé≤</div>
      <div id="d2">üé≤</div>
    </div>

    <button id="rollBtn" onclick="roll()">Kast terning</button>

  </div>
</div>

<div id="card" onclick="closeCard()">
  <div id="cardContent">
    <div id="cardText"></div>
    <p><small>(Trykk for √• fortsette)</small></p>
  </div>
</div>

<script>

/* ===== ROTASJONSSJEKK ===== */
function checkOrientation() {
  const warning = document.getElementById("rotateWarning");
  if (window.innerHeight > window.innerWidth) {
    warning.style.display = "flex";
  } else {
    warning.style.display = "none";
  }
}
window.addEventListener("resize", checkOrientation);
checkOrientation();

/* ===== KONSTANTER ===== */
const JAIL_POS = 20;

const tiles = [
[
  // TOP (8)
  {x:9.5,y:14.5,type:"start"},
  {x:21,y:14.5,type:"drink",amount:2},
  {x:32,y:14.5,type:"nothing"},
  {x:43,y:14.5,type:"2points"},
  {x:54,y:14.5,type:"back",amount:2},
  {x:65,y:14.5,type:"drink",amount:3},
  {x:76,y:14.5,type:"lust"},
  {x:87,y:14.5,type:"go_jail"},

  // RIGHT (4)
  {x:87,y:31,type:"nothing"},
  {x:87,y:48,type:"drink",amount:2},
  {x:87,y:65,type:"dare"},
  {x:87,y:82,type:"back",amount:2},

  // BOTTOM (7 + hj√∏rne = 8)
  {x:76,y:82,type:"drink",amount:1},
  {x:65,y:82,type:"dare"},
  {x:54,y:82,type:"2points"},
  {x:43,y:82,type:"drink",amount:2},
  {x:32,y:82,type:"nothing"},
  {x:21,y:82,type:"dare"},
  {x:9.5,y:82,type:"jail"},

  // LEFT (4 tilbake til start)
  {x:9.5,y:65,type:"2points"},
  {x:9.5,y:48,type:"nothing"},
  {x:9.5,y:31,type:"drink",amount:2},
  {x:9.5,y:14.5,type:"lust"}
]
];

const lustCards = [
  "Kyss partneren i 20 sekunder","Mass√©r l√•rene i 1 minutt","Hvisk noe skittent",
  "Gjett favoritt reisem√•l ‚Äì feil: drikk 2 slurker","Stryk hendene p√• et valgfritt sted p√• partner i 30 sek",
  "Si favoritt sexstilling","F√• et kyss et sted du velger","Velg hvem som tar av et plagg",
  "Klin i 30 sek ‚Äì ta av partner 1 plagg","Fortell hvor du √∏nsker √• ha sex",
  "Hva var mest attraktivt ved f√∏rste m√∏te?","Stirr i √∏ynene 30 sek mens du koser l√•ret",
  "Fortell favorittegenskaper","Kyss halsen i 30 sek","Nevn 2 ting som tenner deg","Sitt i fanget til partner √©n runde"
];

const dareCards = [
  "Ta av ett plagg","Drikk 3 slurker","La partneren velge neste kort",
  "Slikk partner et sted du √∏nsker","Tease i 40 sek ‚Äì partner drikker 3 slurker",
  "Stimuler partner nedentil i 30 sek","Gi en lap dance i 40 sek",
  "Hvis naken: valgfri stilling i 3 min ‚Äì ellers 5 slurker",
  "Bind for √∏ynene ‚Äì partner overrasker i 1 min","Ta av 3 plagg og ta 2 slurker"
];

let players = [
  {pos:0, el:null, name:"Spiller 1", jailed:false, jailAttempts:0, points:0, laps:0},
  {pos:0, el:null, name:"Spiller 2", jailed:false, jailAttempts:0, points:0, laps:0}
];

let current = 0;
let locked = false;
let winner = null;

players[0].el = document.getElementById("p1");
players[1].el = document.getElementById("p2");

const score1 = document.getElementById("score1");
const score2 = document.getElementById("score2");
const turnIndicator = document.getElementById("turnIndicator");
const d1 = document.getElementById("d1");
const d2 = document.getElementById("d2");
const card = document.getElementById("card");
const cardText = document.getElementById("cardText");
const name1Input = document.getElementById("name1Input");
const name2Input = document.getElementById("name2Input");

function place(p) {
  const board = document.getElementById("board");
  const t = tiles[p.pos];
  p.el.style.left = (board.clientWidth * t.x / 100) + "px";
  p.el.style.top = (board.clientHeight * t.y / 100) + "px";
}

function updateScores() {
  score1.textContent = `${players[0].name}: ${players[0].points} ‚≠ê`;
  score2.textContent = `${players[1].name}: ${players[1].points} ‚≠ê`;
}

function updateTurnIndicator() {
  turnIndicator.textContent = winner
    ? `üèÜ Vinner: ${winner.name}`
    : `‚û°Ô∏è Din tur: ${players[current].name}`;
}

function draw(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

function rand(n) {
  return Math.floor(Math.random() * n) + 1;
}

function animateDice(cb) {
  let rolls = 12;
  let d1val = 1, d2val = 1;

  const interval = setInterval(() => {
    d1val = rand(6);
    d2val = rand(6);
    d1.textContent = d1val;
    d2.textContent = d2val;
    rolls--;

    if (rolls === 0) {
      clearInterval(interval);
      setTimeout(() => {
        cb(d1val, d2val);
        if (navigator.vibrate) navigator.vibrate(50);
      }, 150);
    }
  }, 90);
}

function roll() {
  if (locked || winner) return;
  locked = true;

  players[0].name = name1Input.value.trim() || "Spiller 1";
  players[1].name = name2Input.value.trim() || "Spiller 2";

  updateScores();
  updateTurnIndicator();

  animateDice((d1val, d2val) => {
    const p = players[current];

    if (p.jailed) {
      if (d1val === 6 || d2val === 6) {
        p.jailed = false;
        p.jailAttempts = 0;
        move(d1val + d2val);
      } else {
        p.jailAttempts++;
        showCard("üöì Fengsel", `Ingen 6 ‚Äì ta ${p.jailAttempts * 2} slurker`);
        endTurn();
      }
      return;
    }

    move(d1val + d2val);
  });
}

function move(steps) {
  const p = players[current];
  let moved = 0;

  const stepAnim = setInterval(() => {
    const oldPos = p.pos;
    p.pos = (p.pos + 1) % tiles.length;

    if (oldPos === tiles.length - 1 && p.pos === 0) {
      p.laps++;
      if (p.laps === 6 && !winner) {
        winner = p;
        showCard("üéÜ Gratulerer!", `${p.name} har vunnet!`);
        clearInterval(stepAnim);
        updateTurnIndicator();
        return;
      }
    }

    place(p);

    moved++;
    if (moved >= steps) {
      clearInterval(stepAnim);
      resolve(tiles[p.pos]);
    }
  }, 300);
}

function resolve(tile) {
  const p = players[current];

  switch(tile.type) {
    case "go_jail":
      p.pos = JAIL_POS;
      p.jailed = true;
      p.jailAttempts = 0;
      place(p);
      showCard("üöì Fengsel", "Du sendes rett i fengsel!");
      break;

    case "2points":
      p.points += 2;
      updateScores();
      showCard("‚≠ê Poeng", "Du f√•r 2 poeng!");
      break;

    case "lust":
      showCard("‚≠ê Lust", draw(lustCards));
      break;

    case "dare":
      showCard("üî• Dare", draw(dareCards));
      break;

    case "drink":
      showCard("üç∫ Drikk", `Ta ${tile.amount} slurker`);
      break;

    case "back":
      showCard("‚¨Ö Tilbake", `G√• ${tile.amount} ruter tilbake`);
      p.pos = (p.pos - tile.amount + tiles.length) % tiles.length;
      place(p);
      break;

    default:
      endTurn();
      break;
  }
}

function showCard(title, text) {
  cardText.innerHTML = `<h2>${title}</h2><p>${text}</p>`;
  card.style.display = "flex";
}

function closeCard() {
  card.style.display = "none";
  endTurn();
}

function endTurn() {
  if (winner) return;
  current = (current + 1) % players.length;
  locked = false;
  updateTurnIndicator();
}

players.forEach(place);
updateScores();
updateTurnIndicator();

</script>
</body>
</html>


